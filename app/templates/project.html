{% extends "base.html" %}
{% block content %}

<blockquote class="blockquote text-right">
  <p class="mb-0"> {{ quote }} </p>
  <footer class="blockquote-footer"> {{ author }} </footer>
</blockquote>


<h1> {{ project.name }} </h1>
<h3><small class="text-muted"> {{ project.description }}</small></h3>
<hr>
<h3> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –≤ –ø—Ä–æ–µ–∫—Ç–µ: {{ count_tasks_into_project }} </h3>

<div class="accordion" id="accordionExample">
  <div class="card">
    <div class="card-header" id="headingOne">
        <button class="btn btn-outline-dark btn-lg" type="button" data-toggle="collapse" data-target="#collapseOne"
                aria-expanded="true" aria-controls="collapseOne"> –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚öí ({{ work|length }})
        </button>
    </div>
    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
      <div class="card-body">
          {% if work %}
          <table class="table table-hover table-sm text-center align-middle">
              <thead class="thead-dark">
              <tr>
                  <th class='align-middle'> ‚Ññ –ø/–ø </th>
                  <th class='align-middle'> –ù–∞–∑–≤–∞–Ω–∏–µ </th>
                  <th class='align-middle'> –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç </th>
                  <th class='align-middle'> –î–µ–¥–ª–∞–π–Ω </th>
                  <th class='align-middle'> –õ–æ–≥–∏–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è </th>
                  <th class='align-middle'> –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ </th>
                  <th class='align-middle'> –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏</th>
              </tr>
              </thead>
              {% for task in work %}
              <tr>
                  <td class='align-middle'> {{ loop.index }}. </td>
                  <td class='align-middle'> {% include 'subtemplates/_modal_task_td.html' %} </td>
                  <td class='align-middle'> {{ task.priority }} </td>
                  <td class='align-middle'> {{ moment(task.deadline).format('LLL') }}</td>
                  <td class='align-middle'> {{ task.users|map(attribute='username')|join(', ') }} </td>
                  <td class='align-middle'> {{ task.status }} </td>
                  <td class='align-middle'> {{ task.deadline|timedelta }} </td>
              </tr>
              {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>
          {% endif %}
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header" id="headingTwo">
          <button class="btn btn-outline-dark btn-lg" type="button" data-toggle="collapse" data-target="#collapseTwo"
                  aria-expanded="true" aria-controls="collapseTwo">
              –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚öí –ó–∞–¥–∞—á–∏ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏ —É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ üëÄ ({{ consider|length }})
          </button>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
      <div class="card-body">
          {% if consider %}
          <table class="table table-hover table-sm text-center align-middle">
              <thead class="thead-dark">
              <tr>
                  <th class='align-middle'> ‚Ññ –ø/–ø </th>
                  <th class='align-middle'> –ù–∞–∑–≤–∞–Ω–∏–µ </th>
                  <th class='align-middle'> –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç </th>
                  <th class='align-middle'> –î–µ–¥–ª–∞–π–Ω </th>
                  <th class='align-middle'> –õ–æ–≥–∏–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è </th>
                  <th class='align-middle'> –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ </th>
                  <th class='align-middle'> –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏</th>
              </tr>
              </thead>
              {% for task in consider %}
              <tr>
                  <td class='align-middle'> {{ loop.index }}. </td>
                  <td class='align-middle'> {% include 'subtemplates/_modal_task_td.html' %} </td>
                  <td class='align-middle'> {{ task.priority }} </td>
                  <td class='align-middle'> {{ moment(task.deadline).format('LLL') }}</td>
                  <td class='align-middle'> {{ task.users|map(attribute='username')|join(', ') }} </td>
                  <td class='align-middle'> {{ task.status }} {% if current_user.is_boss and task.status == "–Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏" %}
                      <a href="{{ url_for('main.render_task_confirmation', task_id=task.id) }}">
                          <img src="{{ url_for('static', filename='check.png') }}"
                               width="16" height="16" title="–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞—è–≤–∫—É"> </a>{% endif %} </td>
                  <td class='align-middle'> {{ task.deadline|timedelta }} </td>
              </tr>
              {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –ó–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ –¥–∞–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–µ –ø–æ—Å—Ç—É–ø–∞–ª–æ</p>
          {% endif %}
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header" id="headingThree">
        <button class="btn btn-outline-dark btn-lg" type="button" data-toggle="collapse" data-target="#collapseThree"
                aria-expanded="false" aria-controls="collapseThree"> –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚úÖ ({{ executed|length }}) </button>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
      <div class="card-body">
          {% if executed %}
          <table class="table table-hover table-sm text-center align-middle">
              <thead class="thead-dark">
              <tr>
                  <th class='align-middle'> ‚Ññ –ø/–ø </th>
                  <th class='align-middle'> –ù–∞–∑–≤–∞–Ω–∏–µ </th>
                  <th class='align-middle'> –õ–æ–≥–∏–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è </th>
                  <th class='align-middle'> –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è </th>
                  <th class='align-middle'> –õ–æ–≥–∏–Ω –∑–∞–∫—Ä—ã–≤—à–µ–≥–æ –∑–∞–¥–∞—á—É</th>
                  <th class='align-middle'> ‚Ññ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è</th>
                  <th class='align-middle'> –î–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∏</th>
              </tr>
              </thead>
              {% for task in executed %}
              <tr>
                  <td class='align-middle'> {{ loop.index }}. </td>
                  <td class='align-middle'> {% include 'subtemplates/_modal_task_td.html' %} </td>
                  <td class='align-middle'> {{ task.executor.username }}</td>
                  <td class='align-middle'> {{ moment(task.completed_on).format('LLL') }}</td>
                  <td class='align-middle'> {{ task.closer }} </td>
                  <td class='align-middle'> {% if task.executed_number %} {{ task.executed_number }} {% else %} –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è {% endif %}</td>
                  <td class='align-middle'> {% if task.executed_date %} {{ moment(task.executed_date).format('LL') }} {% else %} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç {% endif %}</td>
              </tr>
              {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç </p>
          {% endif %}
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="/static/plotly/plotly-locale-ru.js"></script>
<script>Plotly.setPlotConfig({locale: 'ru'})</script>
{% autoescape off %}
{{ fig }}

{% if executed %}
{{ pie }}
{% endif %}
{% endautoescape %}

{% endblock %}

