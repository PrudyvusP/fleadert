{% extends "base.html" %}

{% block content %}
<style> {% include 'subtemplates/tasks.css' %}</style>
<script src="/static/bootstrap/js/tablesort.min.js"></script>

<blockquote class="blockquote text-right">
  <p class="mb-0"> {{ quote }} </p>
  <footer class="blockquote-footer"> {{ author }} </footer>
</blockquote>

<h1> {{ project.name }} </h1>
<h3><small class="text-muted"> {{ project.description }}</small></h3>
<hr>
<h3> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –≤ –ø—Ä–æ–µ–∫—Ç–µ: {{ project.tasks|length }} </h3>

<div class="accordion" id="accordionExample">
  <div class="card">
    <div class="card-header" id="headingOne">
      <h5 class="mb-0">
        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            <p class="h4 text-dark"> –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚öí ({{ work|length }}) </p>
        </button>
      </h5>
    </div>
    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
      <div class="card-body">
          {% if work %}
          <table class="table table-hover table-sm text-center" id="table-id">
              {% include 'subtemplates/_project_table_head.html' %}
              {% for task in work %}
              {% include 'subtemplates/_project_table_body.html' %}
              {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>
          {% endif %}
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
           <p class="h4 text-dark"> –ó–∞–¥–∞—á–∏ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏ —É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ üëÄ ({{ consider|length }})</p>
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
      <div class="card-body">
          {% if consider %}
          <table class="table table-hover table-sm text-center" id="table-id">
              {% include 'subtemplates/_project_table_head.html' %}
              {% for task in consider %}
              {% include 'subtemplates/_project_table_body.html' %}
              {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –ó–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ –¥–∞–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–µ –ø–æ—Å—Ç—É–ø–∞–ª–æ</p>
          {% endif %}
      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
            <p class="h4 text-dark"> –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚úÖ ({{ executed|length }})</p>
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
      <div class="card-body">
          {% if executed %}
          <table class="table table-hover table-sm text-center" id="table-id">
          <thead class="thead-dark">
          <tr>
              <th> –ù–∞–∑–≤–∞–Ω–∏–µ </th>
              <th data-sort-method='none'> –î–µ–¥–ª–∞–π–Ω </th>
              <th> –õ–æ–≥–∏–Ω –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è </th>
              <th> –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è </th>
              <th> ‚Ññ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è</th>
          </tr>
          </thead>
          {% for task in executed %}
              <tr>
                  <td class="rofl"> {% include 'subtemplates/_modal_task_td.html' %} </td>
                  <td class="align-middle"> {{ moment(task.deadline).format('LLL') }}</td>
                  <td class="align-middle"> {{ task.executor.username }}</td>
                  <td class="align-middle"> {{ moment(task.completed_on).format('LLL') }}</td>
                  <td class="align-middle"> {{ task.executed_number }}</td>
              </tr>
          {% endfor %}
          </table>
          {% else %}
          <p class="h5"> –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç </p>
          {% endif %}
      </div>
    </div>
  </div>
</div>

{% autoescape off %}
{{ fig }}
{{ pie }}
{% endautoescape %}

<script>
  new Tablesort(document.getElementById('table-id'));
</script>
{% endblock %}

